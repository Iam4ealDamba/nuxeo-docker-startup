##=============================================================================
## Nuxeo configuration file
##=============================================================================
## See https://doc.nuxeo.com/nxdoc/configuration-parameters-index-nuxeoconf/
## for detailed information about the settings below.

##-----------------------------------------------------------------------------
## Java
##-----------------------------------------------------------------------------
## You can control the JVM heap size with the following options: InitialRAMPercentage and MaxRAMPercentage.
## They are respectively equivalent to Xms and Xmx, using a percentage of the available memory (or cgroup memory limit
## when running inside a container).
## See https://doc.nuxeo.com/n/HZ3/#java-virtual-machine-settings
JAVA_OPTS=-XX:InitialRAMPercentage=3 -XX:MaxRAMPercentage=25

## File encoding and encoded MIME parameters support
JAVA_OPTS=$JAVA_OPTS -Dfile.encoding=UTF-8 -Dmail.mime.decodeparameters=true

## No ehcache update check
JAVA_OPTS=$JAVA_OPTS -Dnet.sf.ehcache.skipUpdateCheck=true

## Update sort behavior for Arrays and Collections may throw an IllegalArgumentException
JAVA_OPTS=$JAVA_OPTS -Djava.util.Arrays.useLegacyMergeSort=true

## Log Garbage Collector informations into a file
#JAVA_OPTS=$JAVA_OPTS -Xlog:gc*:file=${nuxeo.log.dir}/gc.log

## Prevent the JDK's HTTP client from automatically resending to the server an unsuccessful HTTP POST request
JAVA_OPTS=$JAVA_OPTS -Dsun.net.http.retryPost=false

##-----------------------------------------------------------------------------
## General parameters
##-----------------------------------------------------------------------------
## Will regenerate config from these parameters each time the server
##  is restarted
nuxeo.force.generation=true

##-----------------------------------------------------------------------------
## Database configuration
##-----------------------------------------------------------------------------
nuxeo.db.name=${env:NX_DB_NAME}
nuxeo.db.user=${env:NX_DB_USER}
nuxeo.db.password=${env:NX_DB_PWD}
nuxeo.db.host=${env:NX_DB_HOST}
nuxeo.db.port=${env:NX_DB_PORT}

##-----------------------------------------------------------------------------
## Elasticsearch configuration
##-----------------------------------------------------------------------------
# Enable or disable Elasticsearch integration, default is true.
elasticsearch.enabled=true

## Choose the client protocol to access Elasticsearch, either RestClient
## or TransportClient
elasticsearch.client=RestClient

## node format for RestClient is http://server:9200
elasticsearch.addressList=http://nx-elastic:${env:ES_PORT}
elasticsearch.restClient.username=${env:ES_USER}
elasticsearch.restClient.password=${env:ES_PWD}

## Name of the Elasticsearch index for the default document repository
elasticsearch.indexName=${env:ES_INDEX_NAME}

## Number of replicas, default is 1
elasticsearch.indexNumberOfReplicas=${env:ES_INDEX_REPLICA}

## Embedded elasticsearch server accept HTTP request on port 9200.
## Only requests from local machine are accepted.
elasticsearch.httpEnabled=true

## Enable or disable Elasticsearch as a backend for audit logs.
## Default is false in common-base template for upgrade purposes, to not break an existing instance.
## Set to true for activation on a new instance.
audit.elasticsearch.enabled=true

## Name of the Elasticsearch index for audit logs
audit.elasticsearch.indexName=${elasticsearch.indexName}-audit
## Name of the Elasticsearch index for the uid sequencer
seqgen.elasticsearch.indexName=${elasticsearch.indexName}-uidgen

## See templates/common-base/nuxeo.defaults for more elasticsearch options

##-----------------------------------------------------------------------------
## Mail settings (for notifications)
##-----------------------------------------------------------------------------
#nuxeo.notification.eMailSubjectPrefix="[Nuxeo]"
#mail.transport.host=
#mail.transport.port=
#mail.transport.auth=
#mail.transport.user=
#mail.transport.password=
#mail.from=
#mailservice.user=
#mailservice.password=
#mail.store.protocol=
#mail.transport.protocol=
#mail.user=
#mail.pop3.host=
#mail.debug=

## Encoding of the zip entries filename
#zip.entry.encoding=ascii

##-----------------------------------------------------------------------------
## Nuxeo Dev Mode
##-----------------------------------------------------------------------------
org.nuxeo.runtime.reload_strategy=standby

##-----------------------------------------------------------------------------
## Debugging options
##-----------------------------------------------------------------------------

## ENTRYPOINT: Append required properties
nuxeo.data.dir=/var/lib/nuxeo
nuxeo.log.dir=/var/log/nuxeo
nuxeo.tmp.dir=/tmp
nuxeo.pid.dir=/var/pid/nuxeo
# Set java.io.tmpdir = ${nuxeo.tmp.dir}
launcher.override.java.tmpdir=true

## ENTRYPOINT: Append JAVA_OPTS environment variable
JAVA_OPTS=$JAVA_OPTS -XshowSettings:vm

## ENTRYPOINT: Append dev mode properties
org.nuxeo.dev=true
org.nuxeo.rest.stack.enable=true
# for hot reload
nuxeo.server.sdk=true
nuxeo.server.sdkInstallReloadTimer=true
nuxeo.templates=default,postgresql

### BEGIN - DO NOT EDIT BETWEEN BEGIN AND END ###
JAVA_OPTS=$JAVA_OPTS --add-opens java.base/java.util=ALL-UNNAMED --add-opens java.base/java.lang=ALL-UNNAMED
elasticsearch.addressList=http://nx-elastic:9200
elasticsearch.indexName=nuxeo
elasticsearch.indexNumberOfReplicas=0
elasticsearch.restClient.password=elastic
elasticsearch.restClient.username=elastic
nuxeo.db.host=nx-psql
nuxeo.db.name=postgres
nuxeo.db.password=nuxeo
nuxeo.db.port=5432
nuxeo.db.user=postgres
server.status.key=5c247971
### END - DO NOT EDIT BETWEEN BEGIN AND END ###
